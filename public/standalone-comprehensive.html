<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DataLayer Builder v3.0 - GA4 Schema Generator</title>
    <meta
      name="description"
      content="Healthcare & Pharmaceutical GA4 DataLayer Schema Builder - Complete Standalone Version"
    />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        color: #f8fafc;
        min-height: 100vh;
      }
      .app-container {
        display: flex;
        height: 100vh;
      }
      .sidebar {
        width: 320px;
        background: rgba(255, 255, 255, 0.05);
        border-right: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        overflow-y: auto;
      }
      .main-content {
        flex: 1;
        padding: 1rem;
        overflow-y: auto;
      }
      .header {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 12px;
        padding: 1.5rem 2rem;
        margin-bottom: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .title {
        font-size: 2.5rem;
        font-weight: bold;
        background: linear-gradient(45deg, #22c55e, #16a34a);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .card {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .card h3 {
        color: #22c55e;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .section-toggle {
        background: none;
        border: none;
        color: inherit;
        cursor: pointer;
        width: 100%;
        text-align: left;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .collapsed .collapsible-content {
        display: none;
      }
      .param-item,
      .event-item {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        padding: 0.75rem;
        margin-bottom: 0.5rem;
        cursor: pointer;
        transition: all 0.2s;
        border-style: dashed;
      }
      .param-item:hover,
      .event-item:hover {
        background: rgba(34, 197, 94, 0.1);
        border-color: rgba(34, 197, 94, 0.3);
        border-style: solid;
      }
      .param-name,
      .event-name {
        font-weight: bold;
        color: #22c55e;
      }
      .param-desc,
      .event-desc {
        font-size: 0.85rem;
        opacity: 0.8;
        margin-top: 0.25rem;
        line-height: 1.4;
      }
      .param-example {
        font-size: 0.8rem;
        color: #60a5fa;
        margin-top: 0.25rem;
        font-family: monospace;
      }
      .badge {
        background: rgba(34, 197, 94, 0.2);
        color: #22c55e;
        padding: 0.2rem 0.4rem;
        border-radius: 4px;
        font-size: 0.7rem;
        margin-left: 0.5rem;
        font-weight: 500;
      }
      .category-badge {
        background: rgba(59, 130, 246, 0.2);
        color: #60a5fa;
        padding: 0.2rem 0.4rem;
        border-radius: 4px;
        font-size: 0.7rem;
        margin-left: 0.25rem;
      }
      .schema-builder {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
      }
      .object-blocks {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
      }
      .object-block {
        background: rgba(59, 130, 246, 0.1);
        border: 2px dashed rgba(59, 130, 246, 0.3);
        border-radius: 8px;
        padding: 1rem;
        min-height: 150px;
      }
      .object-block h4 {
        color: #60a5fa;
        margin-bottom: 0.5rem;
      }
      .object-block-desc {
        font-size: 0.8rem;
        opacity: 0.7;
        margin-bottom: 1rem;
      }
      .dropped-param {
        background: rgba(59, 130, 246, 0.2);
        border: 1px solid rgba(59, 130, 246, 0.4);
        border-radius: 6px;
        padding: 0.5rem;
        margin: 0.25rem;
        display: inline-block;
        cursor: pointer;
        font-size: 0.8rem;
      }
      .schema-output {
        background: #1e293b;
        border-radius: 8px;
        padding: 1rem;
        font-family: "Courier New", monospace;
        white-space: pre-wrap;
        max-height: 400px;
        overflow-y: auto;
        border: 1px solid rgba(255, 255, 255, 0.1);
        font-size: 0.9rem;
        line-height: 1.4;
      }
      .btn {
        background: #22c55e;
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        margin: 0.5rem 0.5rem 0.5rem 0;
        font-size: 0.9rem;
      }
      .btn:hover {
        background: #16a34a;
      }
      .btn-secondary {
        background: #3b82f6;
      }
      .btn-secondary:hover {
        background: #2563eb;
      }
      .btn-danger {
        background: #ef4444;
      }
      .btn-danger:hover {
        background: #dc2626;
      }
      .search-box {
        width: 100%;
        padding: 0.5rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 6px;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        margin-bottom: 1rem;
      }
      .search-box::placeholder {
        color: rgba(255, 255, 255, 0.5);
      }
      .filter-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 0.25rem;
        margin-bottom: 1rem;
      }
      .filter-badge {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.8);
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.7rem;
        cursor: pointer;
        transition: all 0.2s;
      }
      .filter-badge.active,
      .filter-badge:hover {
        background: rgba(34, 197, 94, 0.2);
        border-color: rgba(34, 197, 94, 0.4);
        color: #22c55e;
      }
      .event-selected {
        background: rgba(34, 197, 94, 0.2) !important;
        border-color: rgba(34, 197, 94, 0.4) !important;
        border-style: solid !important;
      }
      @media (max-width: 1024px) {
        .app-container {
          flex-direction: column;
        }
        .sidebar {
          width: 100%;
          height: auto;
          max-height: 40vh;
        }
        .schema-builder {
          grid-template-columns: 1fr;
        }
        .object-blocks {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar -->
      <div class="sidebar">
        <div
          style="
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
          "
        >
          <h2
            style="
              display: flex;
              align-items: center;
              gap: 0.5rem;
              font-size: 1.1rem;
            "
          >
            ‚ú® Schema Components
          </h2>
          <p style="font-size: 0.8rem; opacity: 0.7; margin-top: 0.25rem">
            Drag events and parameters to build your GA4 schema
          </p>
        </div>

        <!-- Events Section -->
        <div class="card" style="margin: 1rem; margin-bottom: 0.5rem">
          <button class="section-toggle" onclick="toggleSection('events')">
            <h3>‚ö° GA4 Events</h3>
            <span id="events-toggle">‚ñº</span>
          </button>
          <div class="collapsible-content" id="events-content">
            <input
              type="text"
              placeholder="Search events..."
              class="search-box"
              id="eventSearch"
            />
            <div class="filter-badges" id="eventCategories"></div>
            <div
              id="eventsList"
              style="max-height: 300px; overflow-y: auto"
            ></div>
          </div>
        </div>

        <!-- Parameters Section -->
        <div class="card" style="margin: 1rem">
          <button class="section-toggle" onclick="toggleSection('parameters')">
            <h3>üè• Parameters</h3>
            <span id="parameters-toggle">‚ñº</span>
          </button>
          <div class="collapsible-content" id="parameters-content">
            <input
              type="text"
              placeholder="Search parameters..."
              class="search-box"
              id="paramSearch"
            />
            <div class="filter-badges" id="paramCategories"></div>
            <div
              id="parametersList"
              style="max-height: 400px; overflow-y: auto"
            ></div>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <header class="header">
          <h1 class="title">DataLayer Builder v3.0</h1>
          <p style="opacity: 0.8; margin-top: 0.5rem">
            Healthcare & Pharmaceutical GA4 Schema Generator - Complete
            Standalone Version
          </p>
          <p style="font-size: 0.9rem; opacity: 0.7; margin-top: 1rem">
            Generated: ${new Date().toLocaleString()} | 74+ Parameters | 35+
            Events | Full Functionality
          </p>
        </header>

        <!-- Schema Builder -->
        <div class="card">
          <div
            style="
              display: flex;
              align-items: center;
              justify-content: space-between;
              margin-bottom: 2rem;
            "
          >
            <div>
              <h3>üîß Schema Builder</h3>
              <div style="margin-top: 0.5rem">
                <strong>Selected Event:</strong>
                <span id="selectedEventName">None</span>
                <span
                  id="parameterCount"
                  style="margin-left: 1rem; color: #60a5fa"
                ></span>
              </div>
            </div>
            <div>
              <button class="btn btn-danger" onclick="clearAll()">
                Clear All
              </button>
              <button class="btn btn-secondary" onclick="resetSchema()">
                Reset
              </button>
            </div>
          </div>

          <div class="schema-builder">
            <div>
              <h4 style="color: #60a5fa; margin-bottom: 1rem">
                üìä Object Blocks
              </h4>
              <div class="object-blocks">
                <div class="object-block" data-block="user_data">
                  <h4>üë§ User Data</h4>
                  <p class="object-block-desc">
                    Information about the current user
                  </p>
                  <div id="user_data_params"></div>
                </div>
                <div class="object-block" data-block="page_data">
                  <h4>üìÑ Page Data</h4>
                  <p class="object-block-desc">
                    Information about the current page
                  </p>
                  <div id="page_data_params"></div>
                </div>
                <div class="object-block" data-block="page_data_temp">
                  <h4>üìÑ Page Data (Temp)</h4>
                  <p class="object-block-desc">Temporary page-specific data</p>
                  <div id="page_data_temp_params"></div>
                </div>
                <div class="object-block" data-block="event_data">
                  <h4>‚ö° Event Data</h4>
                  <p class="object-block-desc">
                    Specific data related to this event
                  </p>
                  <div id="event_data_params"></div>
                </div>
              </div>
            </div>

            <div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  margin-bottom: 1rem;
                "
              >
                <h4 style="color: #60a5fa">üìÑ Generated Schema</h4>
                <div>
                  <button class="btn" onclick="generateSchema()">
                    Generate
                  </button>
                  <button class="btn btn-secondary" onclick="exportMarkdown()">
                    Export MD
                  </button>
                  <button class="btn btn-secondary" onclick="copyToClipboard()">
                    Copy Code
                  </button>
                </div>
              </div>
              <div class="schema-output" id="schemaOutput">
                // Select an event and add parameters to generate schema code
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
              // Complete GA4 Events Database with categories and examples
              const GA4_EVENTS = [
                  // Core Navigation & Page Events
                  { name: "page_view", category: "page", description: "Automatically triggered when a user views a page or screen. The foundational event for tracking site/app usage.", example: "Homepage visit, product detail page view" },

                  // User Engagement & Interaction
                  { name: "click", category: "engagement", description: "Triggered when user clicks on tracked elements like buttons, links, or CTAs. Essential for interaction analysis.", example: "Header navigation click, CTA button click, external link click" },
                  { name: "scroll", category: "engagement", description: "Triggered when user scrolls to specific page depths (25%, 50%, 75%, 100%). Measures content engagement.", example: "User scrolls to 75% of article, reaches bottom of product page" },
                  { name: "file_download", category: "engagement", description: "Triggered when user downloads files like PDFs, documents, or media. Tracks content consumption.", example: "PDF brochure download, product catalog download, whitepaper download" },
                  { name: "select_content", category: "engagement", description: "Triggered when user selects specific content or navigates to content sections. Tracks content preferences.", example: "Selecting blog post, choosing product category, picking video" },

                  // Search & Discovery
                  { name: "search", category: "search", description: "Triggered when user performs a search query. Essential for understanding user intent and content gaps.", example: "Site search for 'diabetes medication', product search for 'blood pressure monitor'" },
                  { name: "view_search_results", category: "search", description: "Triggered when search results are displayed to user. Tracks search effectiveness and result relevance.", example: "Drug search returns 15 results, product search shows filtered results" },
                  { name: "select_item", category: "search", description: "Triggered when user selects an item from search results or lists. Measures search success and item appeal.", example: "Clicking on search result, selecting from dropdown suggestions" },

                  // Forms & Lead Generation
                  { name: "form_start", category: "form", description: "Triggered when user begins filling out a form. Critical for conversion funnel analysis and form optimization.", example: "Starting contact form, beginning signup process, starting patient enrollment" },
                  { name: "form_submit", category: "form", description: "Triggered when user successfully submits a form. Key conversion event for lead generation and completion tracking.", example: "Contact form submission, newsletter signup, patient information form completion" },
                  { name: "generate_lead", category: "conversion", description: "Triggered when user action generates a qualified lead. High-value conversion event for business tracking.", example: "Requesting consultation, downloading gated content, requesting drug samples" },

                  // User Account & Authentication
                  { name: "login", category: "user", description: "Triggered when user successfully logs into their account. Tracks user engagement and retention.", example: "Healthcare provider portal login, patient account access" },
                  { name: "sign_up", category: "user", description: "Triggered when user creates a new account. Critical conversion event for user acquisition tracking.", example: "Healthcare provider registration, patient portal signup, newsletter subscription" },
                  { name: "join_group", category: "user", description: "Triggered when user joins a group, program, or community. Tracks program enrollment and community engagement.", example: "Joining patient support group, enrolling in savings program, subscribing to specialty updates" },

                  // E-commerce & Shopping
                  { name: "view_item", category: "ecommerce", description: "Triggered when user views a product or item detail page. Fundamental for product performance analysis.", example: "Viewing medication details, examining medical device specifications" },
                  { name: "view_item_list", category: "ecommerce", description: "Triggered when user views a list of products or items. Tracks browsing behavior and category performance.", example: "Viewing search results, browsing product category, seeing related items" },
                  { name: "add_to_cart", category: "ecommerce", description: "Triggered when user adds items to shopping cart. Key pre-purchase conversion indicator.", example: "Adding prescription to cart, selecting medical supplies, choosing insurance plan" },
                  { name: "remove_from_cart", category: "ecommerce", description: "Triggered when user removes items from cart. Important for cart abandonment analysis and pricing optimization.", example: "Removing expensive medication, changing insurance selection" },
                  { name: "view_cart", category: "ecommerce", description: "Triggered when user views their shopping cart contents. Tracks purchase intent and cart engagement.", example: "Reviewing selected medications, checking total costs, viewing insurance coverage" },
                  { name: "add_to_wishlist", category: "ecommerce", description: "Triggered when user saves items for later purchase. Tracks product interest and future purchase intent.", example: "Saving medication for future reference, bookmarking medical device" },
                  { name: "begin_checkout", category: "ecommerce", description: "Triggered when user starts the checkout process. Critical conversion funnel event for purchase analysis.", example: "Starting prescription order, beginning insurance enrollment, initiating payment process" },
                  { name: "add_payment_info", category: "ecommerce", description: "Triggered when user adds payment information during checkout. Late-stage conversion indicator.", example: "Adding credit card details, selecting insurance payment method, entering bank information" },
                  { name: "add_shipping_info", category: "ecommerce", description: "Triggered when user adds shipping/delivery information. Important step in fulfillment process tracking.", example: "Adding home delivery address, selecting pharmacy pickup location, choosing shipping method" },
                  { name: "purchase", category: "ecommerce", description: "Triggered when user completes a purchase transaction. The ultimate conversion event for revenue tracking.", example: "Prescription purchase completion, insurance plan enrollment, medical device order" },
                  { name: "refund", category: "ecommerce", description: "Triggered when a purchase refund is processed. Important for financial reconciliation and customer satisfaction.", example: "Medication return refund, insurance plan cancellation refund, service fee reversal" },

                  // Promotions & Marketing
                  { name: "view_promotion", category: "marketing", description: "Triggered when user views a promotional offer or advertisement. Tracks marketing campaign effectiveness.", example: "Viewing drug discount offer, seeing savings program banner, promotional popup display" },
                  { name: "select_promotion", category: "marketing", description: "Triggered when user interacts with promotional content. Measures promotion engagement and conversion potential.", example: "Clicking savings program CTA, selecting discount offer, choosing promotional plan" },
                  { name: "ad_impression", category: "marketing", description: "Triggered when an advertisement is displayed to user. Fundamental for ad campaign measurement and reach analysis.", example: "Drug advertisement display, banner ad impression, sponsored content view" },

                  // Content & Media
                  { name: "view_content", category: "content", description: "Triggered when user views specific content pieces. Tracks content performance and user interests.", example: "Reading drug information article, viewing patient education video, accessing treatment guidelines" },
                  { name: "share", category: "content", description: "Triggered when user shares content via social media or other channels. Measures content virality and engagement.", example: "Sharing health article on Facebook, emailing drug information, forwarding patient resources" },

                  // Educational & Onboarding
                  { name: "tutorial_begin", category: "education", description: "Triggered when user starts a tutorial or educational sequence. Important for user onboarding and education tracking.", example: "Starting medication instruction tutorial, beginning insurance navigation guide, starting health assessment" },
                  { name: "tutorial_complete", category: "education", description: "Triggered when user completes a tutorial or educational program. Measures educational effectiveness and completion rates.", example: "Completing injection training, finishing insurance enrollment tutorial, passing medication quiz" },

                  // Technical & System Events
                  { name: "error", category: "technical", description: "Triggered when system errors occur or user encounters technical issues. Critical for site reliability and UX monitoring.", example: "Form submission error, payment processing failure, page load timeout, API connection error" },
                  { name: "set_data", category: "technical", description: "Triggered when data is set or updated in the system. Used for data management and system state tracking.", example: "User preference update, profile information change, system configuration update" },

                  // Media Events
                  { name: "video_start", category: "media", description: "Triggered when user starts playing a video. Essential for video content engagement analysis.", example: "Starting patient education video, playing drug mechanism animation, beginning webinar" },
                  { name: "video_progress", category: "media", description: "Triggered at video progress milestones (25%, 50%, 75%, 100%). Tracks video engagement depth.", example: "Reaching 50% of educational video, completing 75% of treatment explanation" },
                  { name: "video_complete", category: "media", description: "Triggered when user completes watching a video. Measures full content consumption and engagement quality.", example: "Finishing medication instruction video, completing patient testimonial, watching full webinar" },

                  // Custom Events
                  { name: "custom_event", category: "custom", description: "Custom-defined event for specific business requirements. Flexible event for unique tracking needs.", example: "Drug interaction check, dosage calculator use, appointment scheduling, specialty program enrollment" }
              ];

              // Complete Healthcare/Pharmaceutical Parameters Database
              const PARAMETERS = [
                  // Drug Information
                  { name: 'drug_name', type: 'string', category: 'drug', description: 'Generic or full name of the pharmaceutical drug', example: 'Metformin Hydrochloride' },
                  { name: 'drug_brand', type: 'string', category: 'drug', description: 'Brand name of the drug', example: 'Lipitor' },
                  { name: 'drug_type', type: 'string', category: 'drug', description: 'Classification type of the drug', example: 'prescription' },
                  { name: 'drug_classes', type: 'array', category: 'drug', description: 'Array of drug classification categories', example: '["ACE Inhibitor", "Cardiovascular"]' },
                  { name: 'drug_speciality', type: 'string', category: 'drug', description: 'Medical specialty associated with drug', example: 'cardiology' },
                  { name: 'drug_specialties', type: 'array', category: 'drug', description: 'Multiple medical specialties for the drug', example: '["cardiology", "internal_medicine"]' },
                  { name: 'drug_specialty', type: 'string', category: 'drug', description: 'Primary medical specialty for drug', example: 'oncology' },
                  { name: 'dosage', type: 'string', category: 'drug', description: 'Dosage amount and unit for the drug', example: '10mg' },
                  { name: 'indication', type: 'string', category: 'drug', description: 'Primary medical indication for drug use', example: 'hypertension' },
                  { name: 'indications', type: 'array', category: 'drug', description: 'Array of medical indications for drug use', example: '["diabetes", "weight_management"]' },
                  { name: 'enhanced_drug', type: 'boolean', category: 'drug', description: 'Whether drug has enhanced features or information', example: 'true' },
                  { name: 'qty', type: 'number', category: 'drug', description: 'Quantity of drug units', example: '30' },

                  // Healthcare Provider Information
                  { name: 'healthcare_provider_id', type: 'string', category: 'hcp', description: 'Unique identifier for healthcare provider', example: 'hcp_12345' },
                  { name: 'hcp_status', type: 'string', category: 'hcp', description: 'Status or verification level of healthcare provider', example: 'verified' },
                  { name: 'alreadyHadNPI', type: 'boolean', category: 'hcp', description: 'Whether healthcare provider already has NPI number', example: 'true' },
                  { name: 'npiNetNew', type: 'boolean', category: 'hcp', description: 'Whether this is a new NPI registration', example: 'false' },

                  // Insurance & Coverage
                  { name: 'insurance_name', type: 'string', category: 'insurance', description: 'Name of the insurance provider', example: 'Blue Cross Blue Shield' },
                  { name: 'insurance_state', type: 'string', category: 'insurance', description: 'State where insurance coverage applies', example: 'CA' },
                  { name: 'payer', type: 'string', category: 'insurance', description: 'Insurance payer organization', example: 'Aetna' },
                  { name: 'mco', type: 'string', category: 'insurance', description: 'Managed Care Organization identifier', example: 'Kaiser Permanente' },
                  { name: 'mcoQuery', type: 'string', category: 'insurance', description: 'Query term used to search for MCO', example: 'kaiser' },
                  { name: 'planType', type: 'string', category: 'insurance', description: 'Type of insurance plan', example: 'HMO' },
                  { name: 'coverageRestrictions', type: 'array', category: 'insurance', description: 'Array of coverage restrictions or limitations', example: '["prior_auth_required", "step_therapy"]' },
                  { name: 'pa_approved', type: 'boolean', category: 'insurance', description: 'Whether prior authorization is approved', example: 'true' },
                  { name: 'stepTherapies', type: 'array', category: 'insurance', description: 'Required step therapy medications', example: '["metformin", "sulfonylurea"]' },
                  { name: 'tier', type: 'number', category: 'insurance', description: 'Formulary tier level of the drug', example: '2' },

                  // User & Session Information
                  { name: 'user_already_exists', type: 'boolean', category: 'user', description: 'Whether user account already exists', example: 'false' },
                  { name: 'user_key', type: 'string', category: 'user', description: 'Unique user identification key', example: 'usr_abc123' },
                  { name: 'user_role', type: 'string', category: 'user', description: 'Role or type of user in the system', example: 'healthcare_provider' },
                  { name: 'aim_session_id', type: 'string', category: 'user', description: 'Session identifier for analytics tracking', example: 'sess_xyz789' },

                  // Professional Information
                  { name: 'employerName', type: 'string', category: 'professional', description: 'Name of the healthcare provider\'s employer', example: 'Mayo Clinic' },
                  { name: 'employerQuery', type: 'string', category: 'professional', description: 'Search query used to find employer', example: 'mayo clinic minnesota' },

                  // Interaction & Engagement
                  { name: 'action', type: 'string', category: 'interaction', description: 'Specific action taken by user', example: 'drug_search' },
                  { name: 'button_text', type: 'string', category: 'interaction', description: 'Text content of clicked button', example: 'Find Coverage Options' },
                  { name: 'cta_button_name', type: 'string', category: 'interaction', description: 'Name identifier of call-to-action button', example: 'request_samples' },
                  { name: 'cta_type', type: 'string', category: 'interaction', description: 'Type of call-to-action interaction', example: 'primary_cta' },
                  { name: 'link_text', type: 'string', category: 'interaction', description: 'Text content of clicked link', example: 'Learn More About Side Effects' },
                  { name: 'link_url', type: 'string', category: 'interaction', description: 'URL destination of clicked link', example: 'https://example.com/drug-info' },
                  { name: 'drop_down_text', type: 'string', category: 'interaction', description: 'Selected text from dropdown menu', example: 'Cardiology' },
                  { name: 'clipboard_text', type: 'string', category: 'interaction', description: 'Text copied to clipboard', example: 'Drug Name: Lipitor 20mg' },
                  { name: 'has_interaction', type: 'boolean', category: 'interaction', description: 'Whether user had any interaction on page', example: 'true' },
                  { name: 'scroll_depth', type: 'number', category: 'interaction', description: 'Percentage of page scrolled by user', example: '75' },

                  // Content & Resources
                  { name: 'resource_name', type: 'string', category: 'content', description: 'Name of the accessed resource', example: 'Patient Education Brochure' },
                  { name: 'resource_parent', type: 'string', category: 'content', description: 'Parent category of the resource', example: 'Educational Materials' },
                  { name: 'resource_parent_section', type: 'string', category: 'content', description: 'Parent section containing the resource', example: 'Patient Resources' },
                  { name: 'resource_section', type: 'string', category: 'content', description: 'Specific section of the resource', example: 'Side Effects' },
                  { name: 'pdf_link', type: 'string', category: 'content', description: 'URL link to PDF document', example: 'https://example.com/drug-guide.pdf' },

                  // Search & Discovery
                  { name: 'search_term', type: 'string', category: 'search', description: 'Search query entered by user', example: 'blood pressure medication' },
                  { name: 'resultsCount', type: 'number', category: 'search', description: 'Number of search results returned', example: '42' },
                  { name: 'check_drugs', type: 'boolean', category: 'search', description: 'Whether user checked drug interactions', example: 'true' },

                  // Form & Application Data
                  { name: 'question_1', type: 'string', category: 'form', description: 'Answer to first form question', example: 'Yes, I have diabetes' },
                  { name: 'question_2', type: 'string', category: 'form', description: 'Answer to second form question', example: 'Type 2 diabetes' },
                  { name: 'application_link', type: 'string', category: 'form', description: 'Link to application or enrollment form', example: 'https://example.com/apply' },

                  // Program & Treatment Information
                  { name: 'program_name', type: 'string', category: 'program', description: 'Name of patient assistance or treatment program', example: 'Patient Savings Program' },
                  { name: 'treatment', type: 'string', category: 'program', description: 'Treatment or therapy being discussed', example: 'insulin_therapy' },
                  { name: 'pharma_company', type: 'string', category: 'program', description: 'Pharmaceutical company name', example: 'Pfizer Inc.' },

                  // Testing & Experimentation
                  { name: 'experiment_name', type: 'string', category: 'testing', description: 'Name of A/B test or experiment', example: 'homepage_redesign_v2' },
                  { name: 'experiment_treatment', type: 'string', category: 'testing', description: 'Treatment group in A/B test', example: 'variant_b' },

                  // Page Navigation
                  { name: 'page_name', type: 'string', category: 'page', description: 'The name of the page', example: 'Homepage' },
                  { name: 'page_location', type: 'string', category: 'page', description: 'The URL of the page', example: 'https://example.com/page' },
                  { name: 'page_path', type: 'string', category: 'page', description: 'The path portion of the URL', example: '/products/shoes' },
                  { name: 'page_title', type: 'string', category: 'page', description: 'The title of the page', example: 'Product Name - Company' },
                  { name: 'page_section', type: 'string', category: 'page', description: 'Section of the current page', example: 'dosage_information' },

                  // Standard GA4 Parameters
                  { name: 'event_category', type: 'string', category: 'event', description: 'Category classification for the event', example: 'drug_interaction' },
                  { name: 'event_action', type: 'string', category: 'event', description: 'Specific action that triggered the event', example: 'drug_lookup' },
                  { name: 'event_label', type: 'string', category: 'event', description: 'Additional label for event context', example: 'dosage_calculator' },
                  { name: 'value', type: 'number', category: 'event', description: 'Monetary value of transaction or event', example: '25.99' },
                  { name: 'currency', type: 'string', category: 'event', description: 'Currency code for monetary values', example: 'USD' },

                  // Additional Parameters
                  { name: 'item_list_id', type: 'string', category: 'list', description: 'Identifier for item list', example: 'search_results_drugs' },
                  { name: 'item_list_name', type: 'string', category: 'list', description: 'Name of the item list', example: 'Drug Search Results' },
                  { name: 'items', type: 'array', category: 'list', description: 'Array of items in the list', example: '[{"name": "Lipitor", "id": "drug_001"}]' }
              ];

              // Application State
              let selectedEvent = null;
              let objectBlocks = {
                  user_data: [],
                  page_data: [],
                  page_data_temp: [],
                  event_data: []
              };
              let filteredEvents = [...GA4_EVENTS];
              let filteredParameters = [...PARAMETERS];

              // Initialize Application
              function init() {
                  console.log('Initializing DataLayer Builder...');
                  console.log('GA4_EVENTS length:', GA4_EVENTS.length);
                  console.log('PARAMETERS length:', PARAMETERS.length);

                  loadEvents();
                  loadParameters();
                  setupEventListeners();
                  updateParameterCount();

                  console.log('Initialization complete');
              }

              function setupEventListeners() {
                  // Search functionality
                  document.getElementById('eventSearch').addEventListener('input', (e) => {
                      filterEvents(e.target.value);
                  });

                  document.getElementById('paramSearch').addEventListener('input', (e) => {
                      filterParameters(e.target.value);
                  });

                  // Drag and drop for object blocks
                  document.querySelectorAll('.object-block').forEach(block => {
                      block.addEventListener('dragover', handleDragOver);
                      block.addEventListener('drop', handleDrop);
                  });
              }

              function loadEvents() {
                  console.log('Loading events...');
                  const container = document.getElementById('eventsList');
                  const categoriesContainer = document.getElementById('eventCategories');

                  console.log('Events container:', container);
                  console.log('Categories container:', categoriesContainer);

                  // Load category filters
                  const categories = [...new Set(GA4_EVENTS.map(e => e.category))];
                  console.log('Event categories:', categories);
                  categoriesContainer.innerHTML = '<div class="filter-badge active" onclick="filterEventsByCategory(\'\')">All</div>';
                  categories.forEach(cat => {
                      categoriesContainer.innerHTML += \`<div class="filter-badge" onclick="filterEventsByCategory('\${cat}')">\${cat}</div>\`;
                  });

                  renderEvents();
              }

              function renderEvents() {
                  const container = document.getElementById('eventsList');
                  container.innerHTML = '';

                  filteredEvents.forEach(event => {
                      const div = document.createElement('div');
                      div.className = 'event-item';
                      if (selectedEvent && selectedEvent.name === event.name) {
                          div.classList.add('event-selected');
                      }
                      div.draggable = true;
                      div.onclick = () => selectEvent(event);
                      div.ondragstart = (e) => handleEventDragStart(e, event);
                      div.innerHTML = \`
                          <div class="event-name">\${event.name}<span class="category-badge">\${event.category}</span></div>
                          <div class="event-desc">\${event.description}</div>
                          <div class="param-example">Example: \${event.example}</div>
                      \`;
                      container.appendChild(div);
                  });
              }

              function loadParameters() {
                  console.log('Loading parameters...');
                  const categoriesContainer = document.getElementById('paramCategories');

                  console.log('Param categories container:', categoriesContainer);

                  // Load category filters
                  const categories = [...new Set(PARAMETERS.map(p => p.category))];
                  console.log('Parameter categories:', categories);
                  categoriesContainer.innerHTML = '<div class="filter-badge active" onclick="filterParametersByCategory(\'\')">All</div>';
                  categories.forEach(cat => {
                      categoriesContainer.innerHTML += \`<div class="filter-badge" onclick="filterParametersByCategory('\${cat}')">\${cat}</div>\`;
                  });

                  renderParameters();
              }

              function renderParameters() {
                  const container = document.getElementById('parametersList');
                  container.innerHTML = '';

                  filteredParameters.forEach(param => {
                      const div = document.createElement('div');
                      div.className = 'param-item';
                      div.draggable = true;
                      div.onclick = () => addParameterToBlock(param, 'event_data');
                      div.ondragstart = (e) => handleParameterDragStart(e, param);
                      div.innerHTML = \`
                          <div class="param-name">\${param.name}<span class="badge">\${param.type}</span><span class="category-badge">\${param.category}</span></div>
                          <div class="param-desc">\${param.description}</div>
                          <div class="param-example">Example: \${param.example}</div>
                      \`;
                      container.appendChild(div);
                  });
              }

              function selectEvent(event) {
                  selectedEvent = event;
                  document.getElementById('selectedEventName').textContent = event.name;
                  renderEvents(); // Re-render to show selection
                  generateSchema();
              }

              function addParameterToBlock(param, blockKey) {
                  if (!objectBlocks[blockKey].find(p => p.name === param.name)) {
                      objectBlocks[blockKey].push(param);
                      updateObjectBlock(blockKey);
                      updateParameterCount();
                      generateSchema();
                  }
              }

              function removeParameterFromBlock(paramName, blockKey) {
                  objectBlocks[blockKey] = objectBlocks[blockKey].filter(p => p.name !== paramName);
                  updateObjectBlock(blockKey);
                  updateParameterCount();
                  generateSchema();
              }

              function updateObjectBlock(blockKey) {
                  const container = document.getElementById(blockKey + '_params');
                  container.innerHTML = '';

                  objectBlocks[blockKey].forEach(param => {
                      const div = document.createElement('div');
                      div.className = 'dropped-param';
                      div.title = 'Click to remove';
                      div.onclick = () => removeParameterFromBlock(param.name, blockKey);
                      div.innerHTML = \`\${param.name} <span class="badge">\${param.type}</span>\`;
                      container.appendChild(div);
                  });
              }

              function updateParameterCount() {
                  const total = Object.values(objectBlocks).reduce((sum, params) => sum + params.length, 0);
                  document.getElementById('parameterCount').textContent = total > 0 ? \`\${total} parameter\${total !== 1 ? 's' : ''}\` : '';
              }

              function filterEvents(searchTerm) {
                  filteredEvents = GA4_EVENTS.filter(event =>
                      event.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                      event.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
                      event.category.toLowerCase().includes(searchTerm.toLowerCase())
                  );
                  renderEvents();
              }

              function filterParameters(searchTerm) {
                  filteredParameters = PARAMETERS.filter(param =>
                      param.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                      param.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
                      param.category.toLowerCase().includes(searchTerm.toLowerCase())
                  );
                  renderParameters();
              }

              function filterEventsByCategory(category) {
                  // Update filter badges
                  document.querySelectorAll('#eventCategories .filter-badge').forEach(badge => {
                      badge.classList.remove('active');
                  });
                  event.target.classList.add('active');

                  filteredEvents = category ? GA4_EVENTS.filter(e => e.category === category) : [...GA4_EVENTS];
                  renderEvents();
              }

              function filterParametersByCategory(category) {
                  // Update filter badges
                  document.querySelectorAll('#paramCategories .filter-badge').forEach(badge => {
                      badge.classList.remove('active');
                  });
                  event.target.classList.add('active');

                  filteredParameters = category ? PARAMETERS.filter(p => p.category === category) : [...PARAMETERS];
                  renderParameters();
              }

              // Drag and Drop Handlers
              function handleEventDragStart(e, event) {
                  e.dataTransfer.setData('text/plain', JSON.stringify({type: 'event', data: event}));
              }

              function handleParameterDragStart(e, param) {
                  e.dataTransfer.setData('text/plain', JSON.stringify({type: 'parameter', data: param}));
              }

              function handleDragOver(e) {
                  e.preventDefault();
              }

              function handleDrop(e) {
                  e.preventDefault();
                  const blockKey = e.currentTarget.dataset.block;
                  const data = JSON.parse(e.dataTransfer.getData('text/plain'));

                  if (data.type === 'parameter') {
                      addParameterToBlock(data.data, blockKey);
                  }
              }

              function generateSchema() {
                  const output = document.getElementById('schemaOutput');

                  if (!selectedEvent) {
                      output.textContent = '// Select an event to generate schema code';
                      return;
                  }

                  let schema = \`// GA4 DataLayer Event: \${selectedEvent.name}
      // Category: \${selectedEvent.category}
      // Description: \${selectedEvent.description}

      dataLayer.push({
        event: '\${selectedEvent.name}'\`;

                  // Add parameters from all object blocks
                  Object.keys(objectBlocks).forEach(blockKey => {
                      if (objectBlocks[blockKey].length > 0) {
                          schema += \`,

        // \${blockKey.replace('_', ' ').toUpperCase()}\`;
                          objectBlocks[blockKey].forEach(param => {
                              const value = param.type === 'string' ? \`'\${param.example}'\` : param.example;
                              schema += \`,
        \${param.name}: \${value}\`;
                          });
                      }
                  });

                  schema += \`
      });

      // Alternative gtag Implementation
      gtag('event', '\${selectedEvent.name}', {\`;

                  let hasParams = false;
                  Object.keys(objectBlocks).forEach(blockKey => {
                      objectBlocks[blockKey].forEach(param => {
                          const value = param.type === 'string' ? \`'\${param.example}'\` : param.example;
                          schema += \`\${hasParams ? ',' : ''}
        \${param.name}: \${value}\`;
                          hasParams = true;
                      });
                  });

                  schema += \`
      });\`;

                  output.textContent = schema;
              }

              function exportMarkdown() {
                  if (!selectedEvent) {
                      alert('Please select an event first');
                      return;
                  }

                  let markdown = \`# \${selectedEvent.name}

      ## Event Information
      - **Category:** \${selectedEvent.category}
      - **Description:** \${selectedEvent.description}
      - **Example Use Case:** \${selectedEvent.example}

      ## Object Structure

      \`;

                  Object.keys(objectBlocks).forEach(blockKey => {
                      if (objectBlocks[blockKey].length > 0) {
                          markdown += \`### \${blockKey.replace('_', ' ').toUpperCase()}

      | Parameter | Type | Category | Description | Example |
      |-----------|------|----------|-------------|---------|
      \`;
                          objectBlocks[blockKey].forEach(param => {
                              markdown += \`| \${param.name} | \${param.type} | \${param.category} | \${param.description} | \${param.example} |
      \`;
                          });
                          markdown += \`
      \`;
                      }
                  });

                  markdown += \`## Implementation

      ### DataLayer Push
      \\\`\\\`\\\`javascript
      dataLayer.push({
        event: '\${selectedEvent.name}'\`;

                  Object.keys(objectBlocks).forEach(blockKey => {
                      if (objectBlocks[blockKey].length > 0) {
                          objectBlocks[blockKey].forEach(param => {
                              const value = param.type === 'string' ? \`'\${param.example}'\` : param.example;
                              markdown += \`,
        \${param.name}: \${value}\`;
                          });
                      }
                  });

                  markdown += \`
      });
      \\\`\\\`\\\`

      ### gtag Implementation
      \\\`\\\`\\\`javascript
      gtag('event', '\${selectedEvent.name}', {\`;

                  let hasParams = false;
                  Object.keys(objectBlocks).forEach(blockKey => {
                      objectBlocks[blockKey].forEach(param => {
                          const value = param.type === 'string' ? \`'\${param.example}'\` : param.example;
                          markdown += \`\${hasParams ? ',' : ''}
        \${param.name}: \${value}\`;
                          hasParams = true;
                      });
                  });

                  markdown += \`
      });
      \\\`\\\`\\\`

      ---
      *Generated by DataLayer Builder v3.0 - \${new Date().toLocaleString()}*
      \`;

                  // Download markdown file
                  const blob = new Blob([markdown], { type: 'text/markdown' });
                  const url = URL.createObjectURL(blob);
                  const a = document.createElement('a');
                  a.href = url;
                  a.download = \`\${selectedEvent.name}_schema_comprehensive.md\`;
                  a.click();
                  URL.revokeObjectURL(url);
              }

              function copyToClipboard() {
                  const output = document.getElementById('schemaOutput');
                  navigator.clipboard.writeText(output.textContent).then(() => {
                      // Show feedback
                      const btn = event.target;
                      const originalText = btn.textContent;
                      btn.textContent = 'Copied!';
                      btn.style.background = '#22c55e';
                      setTimeout(() => {
                          btn.textContent = originalText;
                          btn.style.background = '#3b82f6';
                      }, 2000);
                  });
              }

              function clearAll() {
                  objectBlocks = {
                      user_data: [],
                      page_data: [],
                      page_data_temp: [],
                      event_data: []
                  };
                  Object.keys(objectBlocks).forEach(updateObjectBlock);
                  updateParameterCount();
                  generateSchema();
              }

              function resetSchema() {
                  selectedEvent = null;
                  document.getElementById('selectedEventName').textContent = 'None';
                  clearAll();
                  renderEvents();
              }

              function toggleSection(sectionId) {
                  const content = document.getElementById(sectionId + '-content');
                  const toggle = document.getElementById(sectionId + '-toggle');
                  const card = content.closest('.card');

                  if (card.classList.contains('collapsed')) {
                      card.classList.remove('collapsed');
                      toggle.textContent = '‚ñº';
                  } else {
                      card.classList.add('collapsed');
                      toggle.textContent = '‚ñ∂';
                  }
              }

              // Initialize when page loads
              document.addEventListener('DOMContentLoaded', init);

              // Console welcome message
              console.log('üéØ DataLayer Builder v3.0 - Complete Standalone Version');
              console.log('üè• Healthcare & Pharmaceutical GA4 Schema Generator');
              console.log('‚úÖ Full functionality available offline');
              console.log(\`üìä \${PARAMETERS.length} parameters loaded\`);
              console.log(\`‚ö° \${GA4_EVENTS.length} events loaded\`);
              console.log('üöÄ Complete application functionality included!');
    </script>
  </body>
</html>
